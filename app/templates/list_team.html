<!DOCTYPE html>
<html lang="zh-Hant" class="h-full w-full">

<head>
  <meta charset="UTF-8" />
  <title>Teams | 中正排球聯盟</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link rel="preconnect" href="https://fonts.gstatic.com/" crossorigin />
  <link rel="stylesheet"
    href="https://fonts.googleapis.com/css2?display=swap&family=Lexend:wght@400;500;700;900&family=Noto+Sans:wght@400;500;700;900" />
  <script src="https://cdn.tailwindcss.com?plugins=forms,container-queries"></script>
</head>

<body>
  <div class="min-h-screen bg-gray-50 font-['Inter','Noto Sans',sans-serif]">
    <div class="flex flex-col h-full min-h-screen">
      <!-- Header -->
      <header
        class="flex items-center justify-between border-b border-[#eaeef1] px-10 py-3 bg-white fixed top-0 left-0 right-0 z-10">
        <div class="flex items-center gap-4">
          <div class="size-4">
            <svg viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg">
              <path d="M44 4H30.6666V17.3334H17.3334V30.6666H4V44H44V4Z" fill="currentColor"></path>
            </svg>
          </div>
          <h2 class="text-lg font-bold text-[#101518] tracking-[-0.015em]">中正排球聯盟</h2>
        </div>
        <div class="flex flex-1 justify-end gap-8">
          <nav class="flex items-center gap-9">
            <a class="text-[#101518] text-sm font-medium" href="{{ url_for('main.dashboard') }}">Dashboard</a>
            <a class="text-[#101518] text-sm font-medium" href="{{ url_for('main.edit_profile') }}">Profile</a>
          </nav>
          <div class="bg-center bg-no-repeat aspect-square bg-cover rounded-full size-10"
            style='background-image: url("https://lh3.googleusercontent.com/aida-public/AB6AXuDt2IBTIdCHam2F8XQEDrt_7eYY2hPMdKkYDilkB7cOMMGaoVDUtqfkgNImtBkTfueXva8doqU8PZT0puBWecaKF0jjDJfIj4MoLjDcgeCN1JjowkQoLT2DgEGahMD-C5OCVo8In0Iauj4aXK-qd2nYxqBaUTOW1h-aDYS6Y5Wo-3yV2Uw23pzgvK4IwYbWqYojbg77RYVqG3TW4uOKXfzdULQgar8h5KQY9Td_ntOiPe6gxvXpea3D4uOTTgsOnI0LlLuuLAv8rTLM");'>
          </div>
        </div>
      </header>

      <div class="flex h-full w-full min-h-screen" style="padding-top: 64px;">
        <!-- Sidebar -->
        <aside class="w-80 h-[calc(100vh-64px)] bg-slate-50 border-r border-[#e5e7eb]
           sticky top-16 flex flex-col overflow-auto p-4">
                    <div class="flex flex-col gap-4 pb-2">
                        <div>
                            <h1 class="text-[#0e141b] text-base font-medium">{{ current_user.name }}</h1>
                            {% if current_user.team.name %}
                                <p class="text-[#4e7097] text-sm">{{ current_user.team.name }} - {{ current_user.role }}</p>
                            {% else %}
                                <p class="text-[#4e7097] text-sm">{{ current_user.role }}</p>
                            {% endif %}
                        </div>
                        <nav class="flex flex-col gap-2">
                            <a href="{{ url_for('main.dashboard') }}">
                                <button
                                    class="text-left flex items-center gap-2 px-3 py-2 rounded-full hover:bg-[#eaeef1]">
                                    <span class="text-sm font-medium text-[#101518]">Dashboard</span>
                                </button>
                            </a>
                            <a href="{{ url_for('main.list_teams') }}">
                                <button
                                    class="text-left flex items-center gap-2 px-3 py-2 rounded-full hover:bg-[#eaeef1]">
                                    <span class="text-sm font-medium text-[#101518]">Teams</span>
                                </button>
                            </a>
                            <a href="{{ url_for('main.matches_page') }}">
                                <button
                                    class="text-left flex items-center gap-2 px-3 py-2 rounded-full hover:bg-[#eaeef1]">
                                    <span class="text-sm font-medium text-[#101518]">Matches</span>
                                </button>
                            </a>
                            <button class="text-left flex items-center gap-2 px-3 py-2 rounded-full hover:bg-[#eaeef1]">
                                <span class="text-sm font-medium text-[#101518]">Settings</span>
                            </button>
                        </nav>
                    </div>
                    <div class="mt-auto">
                        <a href="{{ url_for('main.logout') }}"
                            class="w-full px-3 py-2 bg-blue-100 rounded-lg text-blue-900 hover:bg-blue-200">
                            登出
                        </a>
                    </div>
                </aside>

        <!-- Main Content -->
        <main class="flex-1 flex flex-col h-full min-h-screen bg-white overflow-auto">
          <!-- Page Header -->
          <div class="px-8 py-6 border-b border-[#e5e7eb]">
            <p class="text-[#0e141b] text-[32px] font-bold leading-tight">Teams</p>
            <p class="text-[#4e7097] text-sm mt-1">Welcome back, {{ current_user.name }}</p>
          </div>

          <!-- Filter Controls -->
          <div class="px-8 py-4 flex flex-wrap gap-4 bg-slate-50 border-b border-[#e5e7eb]">
            <div class="flex flex-col">
              <span class="font-medium">隊伍類型</span>
              <div class="relative">
                <select id="team_type" onchange="filterTeams()"
                  class="appearance-none bg-white border border-gray-300 rounded-md pl-4 pr-10 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500">
                  <option value="全部">全部</option>
                  <option value="男排">男排</option>
                  <option value="女排">女排</option>
                </select>
                <svg
                  class="pointer-events-none w-5 h-5 text-gray-400 absolute right-3 top-1/2 transform -translate-y-1/2"
                  fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />
                </svg>
              </div>
            </div>
            <!-- 小組 -->
            <div class="flex flex-col">
              <span class="font-medium">小組</span>
              <div class="relative">
                <select id="team_cycle" onchange="filterTeams()"
                  class="appearance-none bg-white border border-gray-300 rounded-md pl-4 pr-10 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500">
                  <option value="全部">全部</option>
                  <option value="A">A</option>
                  <option value="B">B</option>
                </select>
                <svg
                  class="pointer-events-none w-5 h-5 text-gray-400 absolute right-3 top-1/2 transform -translate-y-1/2"
                  fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />
                </svg>
              </div>
            </div>
          </div>

          <!-- Teams Table -->
          <div class="mb-8 @container px-4 py-3">
            <div class="overflow-x-auto bg-gray-50 border border-[#d4dde2] rounded-xl">
              <table class="min-w-full bg-white" id="teamsTable">
                <thead class="bg-gray-50">
                  <tr>
                    <th class="px-4 py-3 text-left text-sm font-medium">Team Name</th>
                    <th class="px-4 py-3 text-left text-sm font-medium">Type</th>
                    <th class="px-4 py-3 text-left text-sm font-medium">Cycle</th>
                    <th class="px-4 py-3 text-left text-sm font-medium">Captain</th>
                    <th class="px-4 py-3 text-left text-sm font-medium">Members</th>
                  </tr>
                </thead>
                <tbody>
                  {% for team in teams %}
                  <tr class="border-t border-[#d4dde2]" data-team-type="{{ team.team_type or '' }}"
                    data-team-cycle="{{ team.team_cycle or '' }}">
                    <td class="px-4 py-2">{{ team.name }}</td>
                    <td class="px-4 py-2 text-gray-600">{{ team.team_type or '' }}</td>
                    <td class="px-4 py-2 text-gray-600">{{ team.team_cycle or '' }}</td>
                    <td class="px-4 py-2 text-gray-600">{{ team.captain.name if team.captain else '-' }}</td>
                    <td class="px-4 py-2 text-gray-600">
                      {% if team.members %}
                      {{ team.members | selectattr('id', 'ne', team.captain_id) | map(attribute='name') | join(', ') }}
                      {% else %}
                      -
                      {% endif %}
                    </td>
                  </tr>
                  {% endfor %}
                </tbody>
              </table>
            </div>
          </div>

          <!-- Container Query CSS -->
          <style>
            @container (max-width: 120px) {

              th:nth-child(1),
              td:nth-child(1) {
                display: none;
              }
            }

            @container (max-width: 240px) {

              th:nth-child(2),
              td:nth-child(2) {
                display: none;
              }
            }

            @container (max-width: 360px) {

              th:nth-child(3),
              td:nth-child(3) {
                display: none;
              }
            }

            @container (max-width: 480px) {

              th:nth-child(4),
              td:nth-child(4) {
                display: none;
              }
            }

            @container (max-width: 600px) {

              th:nth-child(5),
              td:nth-child(5) {
                display: none;
              }
            }
          </style>

          <!-- Filter Script -->
          <script>
            function filterTeams() {
              const type = document.getElementById('team_type').value;
              const cycle = document.getElementById('team_cycle').value;
              document.querySelectorAll('#teamsTable tbody tr').forEach(row => {
                const rowType = row.getAttribute('data-team-type');
                const rowCycle = row.getAttribute('data-team-cycle');
                const matchesType = (type === '全部' || rowType === type);
                const matchesCycle = (cycle === '全部' || rowCycle === cycle);
                row.style.display = (matchesType && matchesCycle) ? '' : 'none';
              });
            }
          </script>
          </main>
      </div>
</body>

</html>